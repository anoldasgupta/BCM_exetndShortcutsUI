/*<javascriptresource>  <name>BCM> alphasExtractforZbrush...</name>  <category>BCM</category></javascriptresource>*//*    the psd should look like this:    0- solidColor "Color Fill 2" (59) - hidden    1-layer "edges" colorFill(59) - if you nedd mask, this have effects outerglow, middle point 59, -hidden    2-layer "small"(the small detailes) -visible    3-layer "big" (the big detailes) -visible    4-layer "original" (the original) -visible    to run select one zone and run the script*/myFilePath1 = "d:\\work\\alphaBrushes\\Alphas 3d scan\\surface mimic\\surface mimic\\Face\\Face\\Male\\extracturi"// saveAlphas( myFilePath1 );main();function main(){if(!documents.length) return;  var win = new Window( 'dialog', '' );   win.orientation='stack';  win.p1= win.add("panel", undefined, undefined, {borderStyle:"black"});   win.g1 = win.p1.add('group');  win.g1.orientation = "row";  win.g5 =win.p1.add('group');  win.g5.orientation = "column";  win.g5.alignChildren='left';  win.g5.spacing=10;  win.g5.st1 = win.g5.add('statictext',undefined,'The Path');  win.g5.et1 = win.g5.add('edittext');   win.g5.et1.preferredSize=[250,20];win.g100 =win.p1.add('group');win.g100.orientation = "row";win.g100.alignment='center';win.g100.spacing=10;win.g100.bu1 = win.g100.add('button',undefined,'Process');win.g100.bu1.preferredSize=[120,30];win.g100.bu2 = win.g100.add('button',undefined,'Cancel');win.g100.bu2.preferredSize=[120,30];win.g100.bu1.onClick=function(){if(win.g5.et1.text == ''){    alert("No path was entered!");    return;    }    else{        pathStr = win.g5.et1.text;        pathStr = pathStr.replace(/\\/g,"/");        // alert(pathStr);        saveAlphas( pathStr );    }  win.close(0);}win.center();win.g5.et1.focus = true;win.g5.et1.active = true;win.defaultElement = win.g100.bu1;win.cancelElement = win.g100.bu2;win.show(); }function saveAlphas( myFilePath ){try{// in case you don't have the layer egdes// =======================================================select edgesvar idslct = charIDToTypeID( "slct" );    var desc6 = new ActionDescriptor();    var idnull = charIDToTypeID( "null" );        var ref6 = new ActionReference();        var idLyr = charIDToTypeID( "Lyr " );        ref6.putName( idLyr, "edges" );    desc6.putReference( idnull, ref6 );    var idMkVs = charIDToTypeID( "MkVs" );    desc6.putBoolean( idMkVs, false );executeAction( idslct, desc6, DialogModes.NO );// =======================================================showvar idShw = charIDToTypeID( "Shw " );    var desc146 = new ActionDescriptor();    var idnull = charIDToTypeID( "null" );        var list39 = new ActionList();            var ref98 = new ActionReference();            var idLyr = charIDToTypeID( "Lyr " );            var idOrdn = charIDToTypeID( "Ordn" );            var idTrgt = charIDToTypeID( "Trgt" );            ref98.putEnumerated( idLyr, idOrdn, idTrgt );        list39.putReference( ref98 );    desc146.putList( idnull, list39 );executeAction( idShw, desc146, DialogModes.NO );// =======================================================make mask from selectionvar idMk = charIDToTypeID( "Mk  " );    var desc147 = new ActionDescriptor();    var idNw = charIDToTypeID( "Nw  " );    var idChnl = charIDToTypeID( "Chnl" );    desc147.putClass( idNw, idChnl );    var idAt = charIDToTypeID( "At  " );        var ref99 = new ActionReference();        var idChnl = charIDToTypeID( "Chnl" );        var idChnl = charIDToTypeID( "Chnl" );        var idMsk = charIDToTypeID( "Msk " );        ref99.putEnumerated( idChnl, idChnl, idMsk );    desc147.putReference( idAt, ref99 );    var idUsng = charIDToTypeID( "Usng" );    var idUsrM = charIDToTypeID( "UsrM" );    var idRvlS = charIDToTypeID( "RvlS" );    desc147.putEnumerated( idUsng, idUsrM, idRvlS );executeAction( idMk, desc147, DialogModes.NO );// ======================================================= invert maskvar idInvr = charIDToTypeID( "Invr" );executeAction( idInvr, undefined, DialogModes.NO );// ======================================================= select maskvar idsetd = charIDToTypeID( "setd" );    var desc148 = new ActionDescriptor();    var idnull = charIDToTypeID( "null" );        var ref100 = new ActionReference();        var idChnl = charIDToTypeID( "Chnl" );        var idfsel = charIDToTypeID( "fsel" );        ref100.putProperty( idChnl, idfsel );    desc148.putReference( idnull, ref100 );    var idT = charIDToTypeID( "T   " );        var ref101 = new ActionReference();        var idChnl = charIDToTypeID( "Chnl" );        var idOrdn = charIDToTypeID( "Ordn" );        var idTrgt = charIDToTypeID( "Trgt" );        ref101.putEnumerated( idChnl, idOrdn, idTrgt );    desc148.putReference( idT, ref101 );executeAction( idsetd, desc148, DialogModes.NO );// =======================================================invert the selectionvar idInvs = charIDToTypeID( "Invs" );executeAction( idInvs, undefined, DialogModes.NO );   }catch(err){}    // =======================================================var idCrop = charIDToTypeID( "Crop" );    var desc5 = new ActionDescriptor();    var idDlt = charIDToTypeID( "Dlt " );    desc5.putBoolean( idDlt, true );executeAction( idCrop, desc5, DialogModes.NO );// =======================================================var idslct = charIDToTypeID( "slct" );    var desc6 = new ActionDescriptor();    var idnull = charIDToTypeID( "null" );        var ref6 = new ActionReference();        var idLyr = charIDToTypeID( "Lyr " );        ref6.putName( idLyr, "small" );    desc6.putReference( idnull, ref6 );    var idMkVs = charIDToTypeID( "MkVs" );    desc6.putBoolean( idMkVs, false );executeAction( idslct, desc6, DialogModes.NO );// =======================================================var idsave = charIDToTypeID( "save" );    var desc9 = new ActionDescriptor();    var idAs = charIDToTypeID( "As  " );        var desc10 = new ActionDescriptor();        var idEQlt = charIDToTypeID( "EQlt" );        desc10.putInteger( idEQlt, 8 );        var idMttC = charIDToTypeID( "MttC" );        var idMttC = charIDToTypeID( "MttC" );        var idNone = charIDToTypeID( "None" );        desc10.putEnumerated( idMttC, idMttC, idNone );    var idJPEG = charIDToTypeID( "JPEG" );    desc9.putObject( idAs, idJPEG, desc10 );    var idIn = charIDToTypeID( "In  " );    desc9.putPath( idIn, new File( myFilePath + "_s.jpg" ) );    var idDocI = charIDToTypeID( "DocI" );    desc9.putInteger( idDocI, 35 );    var idCpy = charIDToTypeID( "Cpy " );    desc9.putBoolean( idCpy, true );    var idsaveStage = stringIDToTypeID( "saveStage" );    var idsaveStageType = stringIDToTypeID( "saveStageType" );    var idsaveBegin = stringIDToTypeID( "saveBegin" );    desc9.putEnumerated( idsaveStage, idsaveStageType, idsaveBegin );executeAction( idsave, desc9, DialogModes.NO );// =======================================================var idHd = charIDToTypeID( "Hd  " );    var desc13 = new ActionDescriptor();    var idnull = charIDToTypeID( "null" );        var list3 = new ActionList();            var ref9 = new ActionReference();            var idLyr = charIDToTypeID( "Lyr " );            var idOrdn = charIDToTypeID( "Ordn" );            var idTrgt = charIDToTypeID( "Trgt" );            ref9.putEnumerated( idLyr, idOrdn, idTrgt );        list3.putReference( ref9 );    desc13.putList( idnull, list3 );executeAction( idHd, desc13, DialogModes.NO );// =======================================================var idslct = charIDToTypeID( "slct" );    var desc14 = new ActionDescriptor();    var idnull = charIDToTypeID( "null" );        var ref10 = new ActionReference();        var idLyr = charIDToTypeID( "Lyr " );        ref10.putName( idLyr, "big" );    desc14.putReference( idnull, ref10 );    var idMkVs = charIDToTypeID( "MkVs" );    desc14.putBoolean( idMkVs, false );executeAction( idslct, desc14, DialogModes.NO );// =======================================================var idsave = charIDToTypeID( "save" );    var desc15 = new ActionDescriptor();    var idAs = charIDToTypeID( "As  " );        var desc16 = new ActionDescriptor();        var idEQlt = charIDToTypeID( "EQlt" );        desc16.putInteger( idEQlt, 8 );        var idMttC = charIDToTypeID( "MttC" );        var idMttC = charIDToTypeID( "MttC" );        var idNone = charIDToTypeID( "None" );        desc16.putEnumerated( idMttC, idMttC, idNone );    var idJPEG = charIDToTypeID( "JPEG" );    desc15.putObject( idAs, idJPEG, desc16 );    var idIn = charIDToTypeID( "In  " );    desc15.putPath( idIn, new File( myFilePath + "_b.jpg" ) );    var idDocI = charIDToTypeID( "DocI" );    desc15.putInteger( idDocI, 35 );    var idCpy = charIDToTypeID( "Cpy " );    desc15.putBoolean( idCpy, true );    var idsaveStage = stringIDToTypeID( "saveStage" );    var idsaveStageType = stringIDToTypeID( "saveStageType" );    var idsaveBegin = stringIDToTypeID( "saveBegin" );    desc15.putEnumerated( idsaveStage, idsaveStageType, idsaveBegin );executeAction( idsave, desc15, DialogModes.NO );// =======================================================var idHd = charIDToTypeID( "Hd  " );    var desc19 = new ActionDescriptor();    var idnull = charIDToTypeID( "null" );        var list4 = new ActionList();            var ref11 = new ActionReference();            var idLyr = charIDToTypeID( "Lyr " );            var idOrdn = charIDToTypeID( "Ordn" );            var idTrgt = charIDToTypeID( "Trgt" );            ref11.putEnumerated( idLyr, idOrdn, idTrgt );        list4.putReference( ref11 );    desc19.putList( idnull, list4 );executeAction( idHd, desc19, DialogModes.NO );// =======================================================var idslct = charIDToTypeID( "slct" );    var desc20 = new ActionDescriptor();    var idnull = charIDToTypeID( "null" );        var ref12 = new ActionReference();        var idLyr = charIDToTypeID( "Lyr " );        ref12.putName( idLyr, "original" );    desc20.putReference( idnull, ref12 );    var idMkVs = charIDToTypeID( "MkVs" );    desc20.putBoolean( idMkVs, false );executeAction( idslct, desc20, DialogModes.NO );// =======================================================var idsave = charIDToTypeID( "save" );    var desc21 = new ActionDescriptor();    var idAs = charIDToTypeID( "As  " );        var desc22 = new ActionDescriptor();        var idEQlt = charIDToTypeID( "EQlt" );        desc22.putInteger( idEQlt, 8 );        var idMttC = charIDToTypeID( "MttC" );        var idMttC = charIDToTypeID( "MttC" );        var idNone = charIDToTypeID( "None" );        desc22.putEnumerated( idMttC, idMttC, idNone );    var idJPEG = charIDToTypeID( "JPEG" );    desc21.putObject( idAs, idJPEG, desc22 );    var idIn = charIDToTypeID( "In  " );    desc21.putPath( idIn, new File( myFilePath + "_o.jpg" ) );    var idDocI = charIDToTypeID( "DocI" );    desc21.putInteger( idDocI, 35 );    var idCpy = charIDToTypeID( "Cpy " );    desc21.putBoolean( idCpy, true );    var idsaveStage = stringIDToTypeID( "saveStage" );    var idsaveStageType = stringIDToTypeID( "saveStageType" );    var idsaveBegin = stringIDToTypeID( "saveBegin" );    desc21.putEnumerated( idsaveStage, idsaveStageType, idsaveBegin );executeAction( idsave, desc21, DialogModes.NO );// =======================================================var idslct = charIDToTypeID( "slct" );    var desc25 = new ActionDescriptor();    var idnull = charIDToTypeID( "null" );        var ref13 = new ActionReference();        var idLyr = charIDToTypeID( "Lyr " );        ref13.putName( idLyr, "big" );    desc25.putReference( idnull, ref13 );    var idMkVs = charIDToTypeID( "MkVs" );    desc25.putBoolean( idMkVs, false );executeAction( idslct, desc25, DialogModes.NO );// =======================================================var idShw = charIDToTypeID( "Shw " );    var desc26 = new ActionDescriptor();    var idnull = charIDToTypeID( "null" );        var list5 = new ActionList();            var ref14 = new ActionReference();            var idLyr = charIDToTypeID( "Lyr " );            var idOrdn = charIDToTypeID( "Ordn" );            var idTrgt = charIDToTypeID( "Trgt" );            ref14.putEnumerated( idLyr, idOrdn, idTrgt );        list5.putReference( ref14 );    desc26.putList( idnull, list5 );executeAction( idShw, desc26, DialogModes.NO );// =======================================================var idslct = charIDToTypeID( "slct" );    var desc27 = new ActionDescriptor();    var idnull = charIDToTypeID( "null" );        var ref15 = new ActionReference();        var idLyr = charIDToTypeID( "Lyr " );        ref15.putName( idLyr, "small" );    desc27.putReference( idnull, ref15 );    var idMkVs = charIDToTypeID( "MkVs" );    desc27.putBoolean( idMkVs, false );executeAction( idslct, desc27, DialogModes.NO );// =======================================================var idShw = charIDToTypeID( "Shw " );    var desc28 = new ActionDescriptor();    var idnull = charIDToTypeID( "null" );        var list6 = new ActionList();            var ref16 = new ActionReference();            var idLyr = charIDToTypeID( "Lyr " );            var idOrdn = charIDToTypeID( "Ordn" );            var idTrgt = charIDToTypeID( "Trgt" );            ref16.putEnumerated( idLyr, idOrdn, idTrgt );        list6.putReference( ref16 );    desc28.putList( idnull, list6 );executeAction( idShw, desc28, DialogModes.NO );// =======================================================var idslct = charIDToTypeID( "slct" );    var desc29 = new ActionDescriptor();    var idnull = charIDToTypeID( "null" );        var ref17 = new ActionReference();        var idHstS = charIDToTypeID( "HstS" );        var idOrdn = charIDToTypeID( "Ordn" );        var idPrvs = charIDToTypeID( "Prvs" );        ref17.putEnumerated( idHstS, idOrdn, idPrvs );    desc29.putReference( idnull, ref17 );executeAction( idslct, desc29, DialogModes.NO );// =======================================================var idsetd = charIDToTypeID( "setd" );    var desc30 = new ActionDescriptor();    var idnull = charIDToTypeID( "null" );        var ref18 = new ActionReference();        var idChnl = charIDToTypeID( "Chnl" );        var idfsel = charIDToTypeID( "fsel" );        ref18.putProperty( idChnl, idfsel );    desc30.putReference( idnull, ref18 );    var idT = charIDToTypeID( "T   " );        var ref19 = new ActionReference();        var idChnl = charIDToTypeID( "Chnl" );        var idChnl = charIDToTypeID( "Chnl" );        var idMsk = charIDToTypeID( "Msk " );        ref19.putEnumerated( idChnl, idChnl, idMsk );        var idLyr = charIDToTypeID( "Lyr " );        ref19.putName( idLyr, "Color Fill 2" );    desc30.putReference( idT, ref19 );executeAction( idsetd, desc30, DialogModes.NO );try{// =======================================================select edgesvar idslct = charIDToTypeID( "slct" );    var desc152 = new ActionDescriptor();    var idnull = charIDToTypeID( "null" );        var ref105 = new ActionReference();        var idLyr = charIDToTypeID( "Lyr " );        ref105.putName( idLyr, "edges" );    desc152.putReference( idnull, ref105 );    var idMkVs = charIDToTypeID( "MkVs" );    desc152.putBoolean( idMkVs, false );executeAction( idslct, desc152, DialogModes.NO );// ======================================================= delete maskvar idDlt = charIDToTypeID( "Dlt " );    var desc153 = new ActionDescriptor();    var idnull = charIDToTypeID( "null" );        var ref106 = new ActionReference();        var idChnl = charIDToTypeID( "Chnl" );        var idChnl = charIDToTypeID( "Chnl" );        var idMsk = charIDToTypeID( "Msk " );        ref106.putEnumerated( idChnl, idChnl, idMsk );    desc153.putReference( idnull, ref106 );executeAction( idDlt, desc153, DialogModes.NO );// ======================================================= hidevar idHd = charIDToTypeID( "Hd  " );    var desc154 = new ActionDescriptor();    var idnull = charIDToTypeID( "null" );        var list41 = new ActionList();            var ref107 = new ActionReference();            var idLyr = charIDToTypeID( "Lyr " );            var idOrdn = charIDToTypeID( "Ordn" );            var idTrgt = charIDToTypeID( "Trgt" );            ref107.putEnumerated( idLyr, idOrdn, idTrgt );        list41.putReference( ref107 );    desc154.putList( idnull, list41 );executeAction( idHd, desc154, DialogModes.NO );}catch(err){}}